[Manual](#manual) | [API](#api)

# Принципы работы SDK на платформе iOS<a name="manual"></a>

## Оглавление
- [Подключение библиотеки](#connect_lib)
- [Инициализация библиотеки](#initialization)
- [Работа с СДК](#workflow)
- [Особенности работы системы кэширования](#cache)

Этот SDK предназначен для показа рекламных видео клипов и web баннеров в приложениях на платформе iOS. СДК работает автономно, загружает видео контент и управляет им. Для его подключения достаточно импортировать публичный класс ADNetworkSDK с ключом авторизации в рекламной сети и назначить слушателя для получения событий из СДК

Данный SDK используется для работы с рекламой двух видов:

- видео реклама, воспроизводимая в полноэкранном видеоплеере;
- реклама, отображаемая внутри **web-view**.

Решение о показе какого-либо типа рекламы принимается сервером.

В основе работы **SDK** лежит класс **AdNetworkSDK**, который:

- инициирует библиотеку;
- загружает рекламные объявления;
- показывает рекламные объявления.

Для этого в классе имеются открытые методы, вызываемые пользователем. Чтобы реагировать на их выполнение, пользователь SDK должен самостоятельно реализовать интерфейсы слушателей, в зависимости от своих нужд. 

## Подключение SDK <a name="connect_lib"></a>

SDK подключается через **Swift Package Manager**.
Для подключения пакета используется его адрес в GIT:
**https://github.com/GreenGreyStudioOfficial/ADNetwork_iOS_SDK_SP.git**

Для работы с библиотекой необходим **GAME_ID** - идентификатор приложения в системе показа рекламы. Напишите на [a.bobkov@mobidriven.com](a.bobkov@mobidriven.com), чтобы получить идентификатор.

 **==ВАЖНО!==**
 СДК собирает информацию об устройстве, на котором работает. В том числе данные геолокации.
 В соответствии с правилами Apple в настройках проекта приложения необходимо указать параметр ***NSLocationWhenInUseUsageDescription***, где описана причина запроса на использование геолокации. К примеру такая: *This app uses your location to personalize your app experience.*

## Инициализация библиотеки <a name="initialization"></a>

Импортируйте модуль SDK
**import ADNetworkSDK** 

Создайте объект для SDK
**let adManager:ADNetworkSDK** 

Инициализируйте SDK.
**adManager = ADNetworkSDK(key:<GAME_ID>, delegate: self)** 
где key - это ключ, который разработчик получили в учетной записи рекламной сети

Добавьте поддержку протокола **ADNetworkSDKDelegate** для взаимодействия с SDK

## Работа с SDK<a name="workflow"></a>
### Методы класса ADNetworkSDK:

Запрос рекламы
**adManager.load(rewarded: false)** 
Где rewarded - признак, указывающий какой тип рекламы загрузить - с вознаграждением или нет.

Показ рекламы
**adManager.show()** 

Очистка кэша СДК
**adManager.reset(completionHandler: {})**
Удаляет все загруженную рекламу.

### События протокола ADNetworkSDKDelegate:
Для получения событий из СДК необходимо реализовать поддержку методов данного протокола

**haveAdsToShow(available:Bool)** 
Есть или нет загруженная реклама

**downloadComplete(id: String)** 
Загружена реклама

**downloadFailed(id: String, error: String)** 
Не удалось загрузить рекламу

**showStart()** 
Начало показа рекламы

**showClose()**
Экран показа рекламы закрыт

**showComplete(rewarded: Bool, id: String?)** 
Показ рекламы завершен. Где **rewarded** - признак, была ли реклама с вознаграждением или нет, **id** - идентификатор показанной рекламы


**showFailed(error: String)** 
Ошибка показа рекламы

## Особенности работы системы кэширования <a name="cache"></a>

Кэширование рекламных объявлений и их очистка происходит автоматически. Пользователь SDK не может   влиять на данный процесс.

Очистка кэша может происходить:

- по завершению показа ролика;
- по истечению срока его актуальности. Срок актуальности объявления регулирует рекламодатель.

Особенности работы:

1. Если произошла очистка, попытка воспроизведения загруженного в кэш видеоролика выдает ошибку.

2. При повторном вызове **Load** с одним и тем же типом рекламного объявления вызывается **callback** слушателя, если данный тип уже закэширован. Загрузка нового рекламного объявления не происходит.


_____
# API <a name="api"></a>

## Класс AdNetworkSDK
Это интерфейс для взаимодействия с **SDK**.
Включает в себя следующие публичные методы:

Инициализация
**init(key: String, delegate: ADNetworkSDKDelegate)**
key - ключ, который разработчик получил в учетной записи рекламной сети
delegate - класс, который реализует протокол AdNetworkSDKDelegate

Запрос на загрузку рекламы
**func load (rewarded: Bool)**
rewarded - признак, была ли реклама с вознаграждением

Показать рекламу
**func show ()**

Очистка кэша СДК
**func reset (completionHandler: @escaping () -> Void)**

## Протокол AdNetworkSDKDelegate
Это протокол для получения событий из **SDK**.
Включает в себя следующие публичные методы:

**func downloadComplete (id:String)**
Загружена реклама

**func downloadFailed (id:String, error:String)**
Не удалось загрузить рекламу

**func haveAdsToShow (available:Bool)**
Есть или нет загруженная реклама

**func showStart ()**
Начало показа рекламы

**func showClose ()**
Экран показа рекламы закрыт

**func showComplete (id: String?, rewarded: Bool, rewardRecieved: Bool)**
Показ рекламы завершен. 
Где rewarded - признак, была ли реклама с вознаграждением или нет,
id - идентификатор показанной рекламы

**func showFailed (error: String)**
Ошибка показа рекламы

**optional func log (_ message:String)**
Опциональный метод для отладочных сообщений
